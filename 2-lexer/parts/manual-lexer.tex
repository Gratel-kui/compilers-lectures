% manual-lexer.tex

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.60\textwidth}{figs/by-hand}

  \begin{center}
    手写词法分析器
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合{\bf 某种词法单元模式}的{\bf 所有词素}
    \fig{width = 0.50\textwidth}{figs/if-else}
    \ws \quad \ifkw \quad \elsekw \quad \id \quad \intnum \quad \floatnum \quad \relop \quad \assign

    \pause
    \vspace{0.80cm}
    识别字符串$s$中符合{\bf 某种词法单元模式}的\red{\bf 开头第一个词素}

    \pause
    \vspace{0.80cm}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.20cm}
    \fig{width = 0.80\textwidth}{figs/peek-def}

    \vspace{0.30cm}
    \begin{columns}
      \column{0.10\textwidth}
      \column{0.80\textwidth}
        \begin{description}
          \setlength{\itemsep}{8pt}
          \item[line:] 行号, 用于调试
          \item[peek:] \red{\bf 下一个向前看字符 (Lookahead)}
          \item[words:] 从词素到词法单元\blue{\bf 标识符或关键词}的映射表
        \end{description}
      \column{0.10\textwidth}
    \end{columns}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.50cm}
    \ws: \blank \quad \tab \quad \line

    \pause
    \vspace{0.50cm}
    \fig{width = 0.80\textwidth}{figs/ws-code}

    识别空白部分, 但不做处理

    \pause
    \vspace{0.50cm}
    \fig{width = 0.60\textwidth}{figs/ws-code-wrong}
    \red{$Q:$ 这样写, 可不可以?}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.60cm}
    \ws: \blank \quad \tab \quad \line

    \vspace{0.60cm}
    \fig{width = 0.50\textwidth}{figs/ws}

    用于识别\blue{空白符}的状态转移图
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.60cm}
    \num: 整数 (允许以0开头)

    \pause
    \vspace{0.60cm}
    \fig{width = 0.80\textwidth}{figs/number-code}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.60cm}
    \num: 整数 (允许以0开头)

    \vspace{0.60cm}
    \fig{width = 0.80\textwidth}{figs/number}

    用于识别\blue{带科学计数法的浮点数}的状态转移图
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.50cm}
    \id: 字母开头的字母/数字串

    \pause
    \vspace{0.20cm}
    \fig{width = 0.80\textwidth}{figs/id-code}

    \blue{识别词素、\red{\bf 判断是否是预留的关键字}、保存该标识符}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.60cm}
    \id: 字母开头的字母/数字串

    \vspace{0.60cm}
    \fig{width = 0.80\textwidth}{figs/id}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.60cm}
    \relop: $< \quad > \quad <= \quad >= \quad == \quad <>$

    \vspace{0.60cm}
    \fig{width = 0.60\textwidth}{figs/relop}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 特定词法单元模式}的{\bf 开头第一个词素}

    \vspace{0.60cm}
    \fig{width = 0.60\textwidth}{figs/other-code}

    \vspace{0.50cm}
    出现\red{\bf 词法错误}, 直接报告异常字符
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合\red{\bf 某种词法单元模式}的{\bf 开头第一个词素} 
    \blue{($\Call{scan}{\null}$)}
  \end{center}

  \begin{columns}
    \column{0.45\textwidth}
      \fig{width = 1.00\textwidth}{figs/relop}
      % \begin{center}
      %   关系运算符
      % \end{center}
      \fig{width = 1.00\textwidth}{figs/id}
      % \begin{center}
      %   标识符
      % \end{center}
    \column{0.55\textwidth}
      \fig{width = 1.00\textwidth}{figs/number}
      % \begin{center}
      %   数字
      % \end{center}
      \fig{width = 0.60\textwidth}{figs/ws}
      % \begin{center}
      %   空白符
      % \end{center}
  \end{columns}

  \pause
  \vspace{0.30cm}
  \begin{center}
    关键点: 根据\red{\bf 下一个字符}即可判定词法单元的类型 \\[8pt]
    否则, 报告\purple{\bf 该字符有误}, 并忽略该字符
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.80\textwidth}{figs/code-1}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \fig{width = 0.65\textwidth}{figs/code-2}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    识别字符串$s$中符合{\bf 某种词法单元模式}的\red{\bf 所有词素}

    \vspace{1.00cm}
    外层\blue{\bf 循环}调用 \blue{$\Call{scan}{\null}$}

    \vspace{0.60cm}
    或者, 由语法分析器\red{\bf 按需}调用 \blue{$\Call{scan}{\null}$}

    \vspace{0.20cm}
    \fig{width = 0.50\textwidth}{figs/lexer}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \fig{width = 0.80\textwidth}{figs/ws-code}
    \pause
    \fig{width = 0.60\textwidth}{figs/ws-code-wrong}

    \pause
    \texttt{char peek = ''}: 下一个向前看字符

    \pause
    \vspace{0.30cm}
    \red{\bf 循环不变式:} \\[6pt]
    当\textsc{\blue{scan()}} 返回一个词法单元时, \\[3pt]
    \texttt{peek} 是空白符或者是\blue{当前词素后的第一个字符}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%%%%%%